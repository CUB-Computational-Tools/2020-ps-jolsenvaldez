---
title: "Week 3 Problem Set Answers"
subtitle: "Ocean Acidification"
author: "Juliana Olsen-Valdez"
date: "Last knitted `r format(Sys.Date(), '%d %b %Y')`"
output:
  pdf_document:
    toc: yes
    toc_depth: '3'
  html_document:
    df_print: paged
    number_sections: yes
    toc: yes
    toc_float: yes
    toc_depth: 3
    code_folding: show

editor_options:
  chunk_output_type: inline
---

> Click into a code cell (the gray blocks below) to select or edit it. To run a selected code cell, hit `Ctrl`+`Shift`+`Enter` (Windows & Linux) / `Command`+`Shift`+`Enter` (MacOS). Make sure that each code cell runs successfully before you move on to the next one.

```{r load libraries}
library(dplyr)
library(ggplot2)
```

##Questions and Answers
1) Shortly explain (2-3 sentences), in your own words, why ocean acidification occurs, and how it affects ocean ecosystems, particularly calcifying organism. Use the terms included in the Problem Set but keep it concise!

**Question 1 Solution**

Ocean acidification occurs when the atmospheric $CO^2$ increases and leads to a greater amount of carbonic acid $H_2CO_3^{2-}$ in seawater. Carbonic acid dissolves in seawater to create $[H^+]$ ions that bond to suspended carbonate $CO_3^{2-}$ and can dissolve carbonate that is bound in organism shells. Therefore, increased $[H^+]$ leads to lower pH (making seawater more acidic) and limits the $CO_3^{2-}$ available to calcifying organisms.

____________________________________________________

2) Though the pH of seawater remained mostly constant for millions of years before present, in the last hundred years, the pH of surface sea water has fallen from 8.2 to 8.1. Further, it's been hypothesized that the pH will drop another 0.4 (to a value of 7.7) by the year 2100 (Orr et al., 2005). Calculate the percent rise in acidity for the change in pH for past (8.2) to modern (8.1) and modern to future (7.7), keeping in mind that $[H^{+}] = 10^{pH}$. Make your calculation by creating a small data frame. Hint: if you're having trouble knowing where to start, go back to the code from the example in the Week 2 Problem Set. Once you get your percent changes, comment on the magnitude of the values; were they what you were expecting based on the 0.1 and 0.4 changes in pH? 

**Question 2 Solution:**

```{r pH change}
pH_change <- #name the data frame
  tibble (
    Description = c("past","modern", "future"), #give descriptions to the rows
    pH = c(8.2, 8.1, 7.7), #include past and modern pH values
    Hconc = (10^(-pH)), #calculate H+ concentration
    Hconc_diff = (lead(Hconc) / Hconc), #calculate the fractional difference in H+ concentrations and add a column with that value
    Hconc_diff_percent = (Hconc_diff-1)*100 #use the difference in H+ concentration to calculate the percent change in acidity
  )

pH_change #display the data frame
```

The percent change in acidity given a 0.1 change in pH is around 26%. That's a much greater percent change than it would seem based on the seemingly miniscule change in pH. Further, the 0.4 pH change that's predicted for 2100 has an approximately 150% increase in acidity, which is alarming.

______________________________________________________

3) Which of the following would be an appropriate equilibrium equation to represent that the power received from the sun is equal to that emitted by the earth ($P~received = P~emitted$). Hint: this should include a comparison between the two different areas of interest (the circle area that receives energy from the sun, $\pi R^2$, and the earth's surface area that emits energy, $4\pi R^2$) as well as the Solar Constant (So) and the other terms in the Stefan Boltzmann equation? Explain your reasoning behind your choice. 

 a) $So*\pi R^2 = e\sigma T^4*4\pi R^2$
 b) $So* 4\pi R^2 = e\sigma T^4*4\pi R^2$
 c) $So*\pi R^2 = e\sigma T^4*\pi R^2$
 
Q3 Solution:

The correct equation to represent that the power received from the sun is equal to that emitted by the earth is **choice a**, $So*\pi R^2 = e\sigma T^4*4\pi R^2$, because on the left side of the equation, the Solar Constant is being multiplied by the area of a circle on the earth that receives energy from the sun and this area equation should be for a circle, hence $\pi R^2$. The right side of the equation represents the power that the earth emits and has all of the terms of the Stefan-Boltzmann law multiplied by the surface area of the earth. Because the earth emits energy from all sides of its surface, the area term on the right side of the equation should be for surface area, hence $4\pi R^2$.

________________________________________________________

4) In the example above we calculated the Solar Constant, So (in $W/m^2$), which is the energy that the earth receives from the sun. Using this, calculate the black body temperature of the earth. Hint: we do this by using the correct equilibrium equation from question 3, rearranging to solve for temperature, and then simplifying any terms that cancel. Show each of these steps and include the code you wrote to calculate your answer. Assume that the earth is a black body. Lastly, please convert for answer from Kelvin to degrees Celsius knowing that $degrees\ Celcius = Kelvin - 273.15$.

Q4 Solution:

First, I'll rearrange the original equation to solve for temperature: 
$$So*\pi R^2 = e\sigma T^4*4\pi R^2$$

Step 1, move $T^4$ to the left side and all other terms to the right side. I'm also going to remove the term for emissivity (e), since it's just going to be 1:  
$$T^4 = (So*\pi R^2)/(\sigma*4\pi R^2)$$

Step 2, directly compare the area terms to see what can be canceled and/or simplified (in this case the $\pi R^2$ will cancel): 
$$T^4 = (So/4\sigma)*(\pi R^2/4\pi R^2)$$

Step 3, take the fourth root on both sides so that $T^4$ becomes T on the left side: 
$$T = [So/4\sigma]^{1/4}$$

Now I can write code to create a variable and list of values to solve for T. 
```{r Create a variable and list of constants and values, perform a calculation using those values, and solve for the term T in Kelvin}
calc_T_list <- list(So = 1360, C=5.67E-8)
names(calc_T_list)

T1 <- (((calc_T_list$So))/(4*calc_T_list$C))^(1/4)

cat (T1, "K")

T2 <- (T1 - 273.15)

cat (T2, "degrees C")
```
The black body temperature of the earth is **5.12 degrees Celsius**. It's cold without an atmosphere!